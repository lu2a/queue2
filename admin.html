<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لوحة الإدارة - نظام إدارة الانتظار</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Cairo', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .nav-item {
            transition: all 0.3s ease;
        }
        .nav-item:hover {
            background-color: rgba(255, 255, 255, 0.1);
            transform: translateX(-5px);
        }
        .nav-item.active {
            background-color: rgba(255, 255, 255, 0.2);
            border-right: 4px solid #fbbf24;
        }
        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }
        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .arabic-number {
            font-family: 'Cairo', sans-serif;
            font-weight: 700;
        }
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1001;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }
        .notification.show {
            transform: translateX(0);
        }
    </style>
</head>
<body>
    <!-- Login Modal -->
    <div id="loginModal" class="modal show">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4">
            <div class="text-center mb-6">
                <i class="fas fa-lock text-4xl text-purple-600 mb-4"></i>
                <h2 class="text-2xl font-bold text-gray-800">تسجيل الدخول للإدارة</h2>
            </div>
            <form id="loginForm">
                <div class="mb-4">
                    <label class="block text-gray-700 mb-2">البريد الإلكتروني</label>
                    <input type="email" id="email" class="w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-600" required>
                </div>
                <div class="mb-6">
                    <label class="block text-gray-700 mb-2">كلمة المرور</label>
                    <input type="password" id="password" class="w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-600" required>
                </div>
                <button type="submit" class="w-full bg-purple-600 text-white py-3 rounded-lg hover:bg-purple-700 transition-colors">
                    <i class="fas fa-sign-in-alt mr-2"></i>
                    تسجيل الدخول
                </button>
            </form>
        </div>
    </div>

    <!-- Main Content -->
    <div id="mainContent" class="hidden">
        <!-- Sidebar -->
        <div class="fixed right-0 top-0 h-full w-80 bg-white/10 backdrop-blur-md border-l border-white/20 z-40">
            <div class="p-6">
                <div class="text-center mb-8">
                    <i class="fas fa-cog text-4xl text-yellow-300 mb-4"></i>
                    <h1 class="text-2xl font-bold text-white">لوحة الإدارة</h1>
                    <p class="text-gray-200 text-sm mt-2">نظام إدارة الانتظار</p>
                </div>

                <nav class="space-y-2">
                    <a href="#" class="nav-item active flex items-center p-4 rounded-lg text-white" data-section="general">
                        <i class="fas fa-sliders-h ml-3"></i>
                        الإعدادات العامة
                    </a>
                    <a href="#" class="nav-item flex items-center p-4 rounded-lg text-white" data-section="screens">
                        <i class="fas fa-desktop ml-3"></i>
                        إدارة الشاشات
                    </a>
                    <a href="#" class="nav-item flex items-center p-4 rounded-lg text-white" data-section="clinics">
                        <i class="fas fa-hospital ml-3"></i>
                        إدارة العيادات
                    </a>
                    <a href="#" class="nav-item flex items-center p-4 rounded-lg text-white" data-section="calling">
                        <i class="fas fa-bullhorn ml-3"></i>
                        إعدادات النداء
                    </a>
                    <a href="#" class="nav-item flex items-center p-4 rounded-lg text-white" data-section="doctors">
                        <i class="fas fa-user-md ml-3"></i>
                        إدارة الأطباء
                    </a>
                    <a href="#" class="nav-item flex items-center p-4 rounded-lg text-white" data-section="reports">
                        <i class="fas fa-chart-bar ml-3"></i>
                        التقارير
                    </a>
                    <a href="#" class="nav-item flex items-center p-4 rounded-lg text-red-400 hover:bg-red-500/20" data-section="logout">
                        <i class="fas fa-sign-out-alt ml-3"></i>
                        تسجيل الخروج
                    </a>
                </nav>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="mr-80 p-8">
            <!-- General Settings -->
            <div id="general" class="content-section active">
                <div class="bg-white/10 backdrop-blur-md rounded-2xl p-8 border border-white/20">
                    <h2 class="text-3xl font-bold text-white mb-8">
                        <i class="fas fa-sliders-h text-yellow-300 mr-3"></i>
                        الإعدادات العامة
                    </h2>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div class="space-y-6">
                            <div>
                                <label class="block text-white mb-2">اسم المركز</label>
                                <input type="text" id="centerName" class="w-full px-4 py-3 bg-white/20 border border-white/30 rounded-lg text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-300" placeholder="أدخل اسم المركز">
                            </div>
                            
                            <div>
                                <label class="block text-white mb-2">محتوى الشريط الإخباري</label>
                                <textarea id="newsTicker" rows="3" class="w-full px-4 py-3 bg-white/20 border border-white/30 rounded-lg text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-300" placeholder="أدخل نص الشريط الإخباري المتحرك"></textarea>
                            </div>

                            <div>
                                <label class="block text-white mb-2">سرعة الشريط الإخباري</label>
                                <select id="tickerSpeed" class="w-full px-4 py-3 bg-white/20 border border-white/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-yellow-300">
                                    <option value="slow">بطيئة</option>
                                    <option value="normal" selected>عادية</option>
                                    <option value="fast">سريعة</option>
                                </select>
                            </div>
                        </div>

                        <div class="space-y-6">
                            <div>
                                <label class="block text-white mb-2">فترة عرض التنبيه (ثواني)</label>
                                <input type="number" id="alertDuration" min="1" max="30" class="w-full px-4 py-3 bg-white/20 border border-white/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-yellow-300" value="5">
                            </div>

                            <div>
                                <label class="block text-white mb-2">سرعة النطق</label>
                                <select id="speechSpeed" class="w-full px-4 py-3 bg-white/20 border border-white/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-yellow-300">
                                    <option value="slow">بطيئة</option>
                                    <option value="normal" selected>عادية</option>
                                    <option value="fast">سريعة</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-white mb-2">مسار ملفات الصوت</label>
                                <input type="text" id="audioPath" class="w-full px-4 py-3 bg-white/20 border border-white/30 rounded-lg text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-300" value="./audio/" placeholder="مسار فولدر ملفات الصوت">
                            </div>

                            <div>
                                <label class="block text-white mb-2">مسار ملفات الميديا</label>
                                <input type="text" id="mediaPath" class="w-full px-4 py-3 bg-white/20 border border-white/30 rounded-lg text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-yellow-300" value="./media/" placeholder="مسار فولدر ملفات الميديا">
                            </div>
                        </div>
                    </div>

                    <div class="mt-8 flex justify-end">
                        <button id="saveGeneralSettings" class="bg-yellow-400 text-purple-900 px-8 py-3 rounded-lg font-bold hover:bg-yellow-300 transition-colors">
                            <i class="fas fa-save mr-2"></i>
                            حفظ الإعدادات
                        </button>
                    </div>
                </div>
            </div>

            <!-- Screens Management -->
            <div id="screens" class="content-section">
                <div class="bg-white/10 backdrop-blur-md rounded-2xl p-8 border border-white/20">
                    <div class="flex justify-between items-center mb-8">
                        <h2 class="text-3xl font-bold text-white">
                            <i class="fas fa-desktop text-yellow-300 mr-3"></i>
                            إدارة الشاشات
                        </h2>
                        <button id="addScreen" class="bg-green-500 text-white px-6 py-3 rounded-lg hover:bg-green-600 transition-colors">
                            <i class="fas fa-plus mr-2"></i>
                            إضافة شاشة
                        </button>
                    </div>

                    <div id="screensList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- Screens will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Clinics Management -->
            <div id="clinics" class="content-section">
                <div class="bg-white/10 backdrop-blur-md rounded-2xl p-8 border border-white/20">
                    <div class="flex justify-between items-center mb-8">
                        <h2 class="text-3xl font-bold text-white">
                            <i class="fas fa-hospital text-yellow-300 mr-3"></i>
                            إدارة العيادات
                        </h2>
                        <button id="addClinic" class="bg-green-500 text-white px-6 py-3 rounded-lg hover:bg-green-600 transition-colors">
                            <i class="fas fa-plus mr-2"></i>
                            إضافة عيادة
                        </button>
                    </div>

                    <div id="clinicsList" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Clinics will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Calling Settings -->
            <div id="calling" class="content-section">
                <div class="bg-white/10 backdrop-blur-md rounded-2xl p-8 border border-white/20">
                    <h2 class="text-3xl font-bold text-white mb-8">
                        <i class="fas fa-bullhorn text-yellow-300 mr-3"></i>
                        إعدادات النداء
                    </h2>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div class="space-y-6">
                            <div class="bg-white/20 rounded-lg p-6">
                                <h3 class="text-xl font-bold text-white mb-4">نداء العملاء</h3>
                                <div class="space-y-4">
                                    <button id="callSpecificClient" class="w-full bg-blue-500 text-white py-3 rounded-lg hover:bg-blue-600 transition-colors">
                                        <i class="fas fa-user mr-2"></i>
                                        نداء عميل معين
                                    </button>
                                    <button id="repeatCall" class="w-full bg-orange-500 text-white py-3 rounded-lg hover:bg-orange-600 transition-colors">
                                        <i class="fas fa-redo mr-2"></i>
                                        تكرار النداء
                                    </button>
                                </div>
                            </div>

                            <div class="bg-white/20 rounded-lg p-6">
                                <h3 class="text-xl font-bold text-white mb-4">الطوارئ</h3>
                                <button id="emergencyCall" class="w-full bg-red-500 text-white py-3 rounded-lg hover:bg-red-600 transition-colors">
                                    <i class="fas fa-exclamation-triangle mr-2"></i>
                                    استعجال حالة طارئة
                                </button>
                            </div>
                        </div>

                        <div class="space-y-6">
                            <div class="bg-white/20 rounded-lg p-6">
                                <h3 class="text-xl font-bold text-white mb-4">التحكم العام</h3>
                                <div class="space-y-4">
                                    <button id="clearAllQueues" class="w-full bg-gray-600 text-white py-3 rounded-lg hover:bg-gray-700 transition-colors">
                                        <i class="fas fa-broom mr-2"></i>
                                        تصفير جميع العيادات
                                    </button>
                                    <button id="sendAlert" class="w-full bg-purple-500 text-white py-3 rounded-lg hover:bg-purple-600 transition-colors">
                                        <i class="fas fa-bell mr-2"></i>
                                        إرسال تنبيه عام
                                    </button>
                                </div>
                            </div>

                            <div class="bg-white/20 rounded-lg p-6">
                                <h3 class="text-xl font-bold text-white mb-4">الصوتيات</h3>
                                <div class="space-y-4">
                                    <button id="recordAudio" class="w-full bg-green-500 text-white py-3 rounded-lg hover:bg-green-600 transition-colors">
                                        <i class="fas fa-microphone mr-2"></i>
                                        تسجيل صوت من الموبايل
                                    </button>
                                    <button id="playInstant" class="w-full bg-indigo-500 text-white py-3 rounded-lg hover:bg-indigo-600 transition-colors">
                                        <i class="fas fa-play mr-2"></i>
                                        تشغيل ملف صوتي جاهز
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Doctors Management -->
            <div id="doctors" class="content-section">
                <div class="bg-white/10 backdrop-blur-md rounded-2xl p-8 border border-white/20">
                    <div class="flex justify-between items-center mb-8">
                        <h2 class="text-3xl font-bold text-white">
                            <i class="fas fa-user-md text-yellow-300 mr-3"></i>
                            إدارة الأطباء
                        </h2>
                        <div class="flex space-x-4">
                            <button id="importDoctors" class="bg-blue-500 text-white px-6 py-3 rounded-lg hover:bg-blue-600 transition-colors">
                                <i class="fas fa-upload mr-2"></i>
                                استيراد البيانات
                            </button>
                            <button id="addDoctor" class="bg-green-500 text-white px-6 py-3 rounded-lg hover:bg-green-600 transition-colors">
                                <i class="fas fa-plus mr-2"></i>
                                إضافة طبيب
                            </button>
                        </div>
                    </div>

                    <div class="mb-6">
                        <input type="file" id="doctorsFile" accept=".csv,.xlsx" class="hidden">
                        <div class="bg-white/20 rounded-lg p-4">
                            <p class="text-white mb-2">رفع ملف بيانات الأطباء (CSV أو Excel)</p>
                            <p class="text-gray-300 text-sm">الملف يجب أن يحتوي على: رقم الطبيب، الاسم، التخصص، رقم التليفون، الرقم القومي</p>
                        </div>
                    </div>

                    <div id="doctorsList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- Doctors will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Reports -->
            <div id="reports" class="content-section">
                <div class="bg-white/10 backdrop-blur-md rounded-2xl p-8 border border-white/20">
                    <h2 class="text-3xl font-bold text-white mb-8">
                        <i class="fas fa-chart-bar text-yellow-300 mr-3"></i>
                        التقارير والإحصائيات
                    </h2>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="bg-white/20 rounded-lg p-6 text-center">
                            <i class="fas fa-users text-3xl text-yellow-300 mb-4"></i>
                            <h3 class="text-2xl font-bold text-white mb-2 arabic-number">١٢٣٤</h3>
                            <p class="text-gray-200">إجمالي العملاء</p>
                        </div>
                        <div class="bg-white/20 rounded-lg p-6 text-center">
                            <i class="fas fa-clock text-3xl text-yellow-300 mb-4"></i>
                            <h3 class="text-2xl font-bold text-white mb-2 arabic-number">٠٥:٢٣</h3>
                            <p class="text-gray-200">متوسط وقت الانتظار</p>
                        </div>
                        <div class="bg-white/20 rounded-lg p-6 text-center">
                            <i class="fas fa-check-circle text-3xl text-yellow-300 mb-4"></i>
                            <h3 class="text-2xl font-bold text-white mb-2 arabic-number">٩٨٪</h3>
                            <p class="text-gray-200">نسبة الرضا</p>
                        </div>
                        <div class="bg-white/20 rounded-lg p-6 text-center">
                            <i class="fas fa-calendar-day text-3xl text-yellow-300 mb-4"></i>
                            <h3 class="text-2xl font-bold text-white mb-2 arabic-number">١٥٦</h3>
                            <p class="text-gray-200">عملاء اليوم</p>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div class="bg-white/20 rounded-lg p-6">
                            <h3 class="text-xl font-bold text-white mb-4">أكثر العيادات ازدحامًا</h3>
                            <div class="space-y-3">
                                <div class="flex justify-between items-center">
                                    <span class="text-white">عيادة طب الأسرة</span>
                                    <span class="text-yellow-300 arabic-number">٤٥ عميل</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-white">عيادة الباطنة</span>
                                    <span class="text-yellow-300 arabic-number">٣٢ عميل</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-white">عيادة الأطفال</span>
                                    <span class="text-yellow-300 arabic-number">٢٨ عميل</span>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white/20 rounded-lg p-6">
                            <h3 class="text-xl font-bold text-white mb-4">أوقات الذروة</h3>
                            <div class="space-y-3">
                                <div class="flex justify-between items-center">
                                    <span class="text-white">٩:٠٠ ص - ١١:٠٠ ص</span>
                                    <span class="text-yellow-300">ذروة مرتفعة</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-white">٢:٠٠ م - ٤:٠٠ م</span>
                                    <span class="text-yellow-300">ذروة متوسطة</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-white">٦:٠٠ م - ٨:٠٠ م</span>
                                    <span class="text-yellow-300">ذروة مرتفعة</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg">
        <i class="fas fa-check mr-2"></i>
        <span id="notificationText">تم الحفظ بنجاح</span>
    </div>

    <script src="firebase-config.js"></script>
    <script>
        // Authentication
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            // Firebase Authentication
            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    // Hide login modal and show main content
                    document.getElementById('loginModal').classList.remove('show');
                    document.getElementById('mainContent').classList.remove('hidden');
                    
                    showNotification('تم تسجيل الدخول بنجاح');
                    loadData();
                })
                .catch((error) => {
                    showNotification('خطأ في تسجيل الدخول: ' + error.message, 'error');
                });
        });

        // Navigation
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', function(e) {
                e.preventDefault();
                
                // Remove active class from all nav items
                document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));
                
                // Add active class to clicked item
                this.classList.add('active');
                
                // Hide all content sections
                document.querySelectorAll('.content-section').forEach(section => section.classList.remove('active'));
                
                // Show selected section
                const sectionName = this.getAttribute('data-section');
                if (sectionName === 'logout') {
                    auth.signOut().then(() => {
                        location.reload();
                    });
                } else {
                    document.getElementById(sectionName).classList.add('active');
                }
            });
        });

        // Notification system
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');
            
            notificationText.textContent = message;
            notification.className = `notification ${type === 'error' ? 'bg-red-500' : 'bg-green-500'} text-white px-6 py-3 rounded-lg shadow-lg show`;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Load data from Firebase
        function loadData() {
            // Load screens
            screensRef.on('value', (snapshot) => {
                const screens = snapshot.val() || {};
                updateScreensList(screens);
            });

            // Load clinics
            clinicsRef.on('value', (snapshot) => {
                const clinics = snapshot.val() || {};
                updateClinicsList(clinics);
            });

            // Load settings
            settingsRef.on('value', (snapshot) => {
                const settings = snapshot.val() || {};
                updateSettingsForm(settings);
            });

            // Load doctors
            doctorsRef.on('value', (snapshot) => {
                const doctors = snapshot.val() || {};
                updateDoctorsList(doctors);
            });
        }

        // Update screens list
        function updateScreensList(screens) {
            const screensList = document.getElementById('screensList');
            screensList.innerHTML = '';

            Object.keys(screens).forEach(screenId => {
                const screen = screens[screenId];
                const screenCard = createScreenCard(screenId, screen);
                screensList.appendChild(screenCard);
            });
        }

        // Create screen card
        function createScreenCard(screenId, screen) {
            const card = document.createElement('div');
            card.className = 'bg-white/20 rounded-lg p-6 border border-white/30';
            card.innerHTML = `
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-white">شاشة ${convertToArabicNumbers(screenId)}</h3>
                    <div class="flex space-x-2">
                        <button class="bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600 transition-colors" onclick="editScreen('${screenId}')">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 transition-colors" onclick="deleteScreen('${screenId}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
                <div class="space-y-2">
                    <p class="text-gray-200">الحالة: <span class="text-${screen.active ? 'green' : 'red'}-400">${screen.active ? 'نشطة' : 'متوقفة'}</span></p>
                    <p class="text-gray-200">عدد العيادات: <span class="text-yellow-300">${convertToArabicNumbers(screen.clinics ? screen.clinics.length : 0)}</span></p>
                    <p class="text-gray-200">كلمة السر: <span class="text-yellow-300">${screen.password || 'غير محدد'}</span></p>
                </div>
            `;
            return card;
        }

        // Update clinics list
        function updateClinicsList(clinics) {
            const clinicsList = document.getElementById('clinicsList');
            clinicsList.innerHTML = '';

            Object.keys(clinics).forEach(clinicId => {
                const clinic = clinics[clinicId];
                const clinicCard = createClinicCard(clinicId, clinic);
                clinicsList.appendChild(clinicCard);
            });
        }

        // Create clinic card
        function createClinicCard(clinicId, clinic) {
            const card = document.createElement('div');
            card.className = 'bg-white/20 rounded-lg p-6 border border-white/30';
            card.innerHTML = `
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-white">${clinic.name}</h3>
                    <div class="flex space-x-2">
                        <button class="bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600 transition-colors" onclick="editClinic('${clinicId}')">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 transition-colors" onclick="deleteClinic('${clinicId}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
                <div class="space-y-2">
                    <p class="text-gray-200">رقم العيادة: <span class="text-yellow-300">${convertToArabicNumbers(clinicId)}</span></p>
                    <p class="text-gray-200">رقم الشاشة: <span class="text-yellow-300">${convertToArabicNumbers(clinic.screenId || 'غير محدد')}</span></p>
                    <p class="text-gray-200">الحالة: <span class="text-${clinic.active ? 'green' : 'red'}-400">${clinic.active ? 'نشطة' : 'متوقفة'}</span></p>
                    <p class="text-gray-200">الرقم الحالي: <span class="text-yellow-300 arabic-number">${convertToArabicNumbers(clinic.currentNumber || 0)}</span></p>
                </div>
            `;
            return card;
        }

        // Update settings form
        function updateSettingsForm(settings) {
            document.getElementById('centerName').value = settings.centerName || '';
            document.getElementById('newsTicker').value = settings.newsTicker || '';
            document.getElementById('tickerSpeed').value = settings.tickerSpeed || 'normal';
            document.getElementById('alertDuration').value = settings.alertDuration || 5;
            document.getElementById('speechSpeed').value = settings.speechSpeed || 'normal';
            document.getElementById('audioPath').value = settings.audioPath || './audio/';
            document.getElementById('mediaPath').value = settings.mediaPath || './media/';
        }

        // Update doctors list
        function updateDoctorsList(doctors) {
            const doctorsList = document.getElementById('doctorsList');
            doctorsList.innerHTML = '';

            Object.keys(doctors).forEach(doctorId => {
                const doctor = doctors[doctorId];
                const doctorCard = createDoctorCard(doctorId, doctor);
                doctorsList.appendChild(doctorCard);
            });
        }

        // Create doctor card
        function createDoctorCard(doctorId, doctor) {
            const card = document.createElement('div');
            card.className = 'bg-white/20 rounded-lg p-6 border border-white/30';
            card.innerHTML = `
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-white">${doctor.name}</h3>
                    <div class="flex space-x-2">
                        <button class="bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600 transition-colors" onclick="editDoctor('${doctorId}')">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 transition-colors" onclick="deleteDoctor('${doctorId}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
                <div class="space-y-2">
                    <p class="text-gray-200">التخصص: <span class="text-yellow-300">${doctor.specialty}</span></p>
                    <p class="text-gray-200">العيادة: <span class="text-yellow-300">${doctor.clinic || 'غير محدد'}</span></p>
                    <p class="text-gray-200">أيام العمل: <span class="text-yellow-300">${doctor.workDays || 'غير محدد'}</span></p>
                    <p class="text-gray-200">الحالة: <span class="text-${doctor.status === 'active' ? 'green' : 'red'}-400">${doctor.status === 'active' ? 'نشط' : 'غير نشط'}</span></p>
                </div>
            `;
            return card;
        }

        // Save general settings
        document.getElementById('saveGeneralSettings').addEventListener('click', function() {
            const settings = {
                centerName: document.getElementById('centerName').value,
                newsTicker: document.getElementById('newsTicker').value,
                tickerSpeed: document.getElementById('tickerSpeed').value,
                alertDuration: parseInt(document.getElementById('alertDuration').value),
                speechSpeed: document.getElementById('speechSpeed').value,
                audioPath: document.getElementById('audioPath').value,
                mediaPath: document.getElementById('mediaPath').value
            };

            settingsRef.set(settings)
                .then(() => {
                    showNotification('تم حفظ الإعدادات بنجاح');
                })
                .catch((error) => {
                    showNotification('خطأ في الحفظ: ' + error.message, 'error');
                });
        });

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize animations
            anime({
                targets: '.card-hover',
                translateY: [50, 0],
                opacity: [0, 1],
                delay: anime.stagger(200),
                duration: 800,
                easing: 'easeOutQuart'
            });
        });
    </script>
</body>
</html>